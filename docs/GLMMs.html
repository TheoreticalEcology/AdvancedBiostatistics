<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 GLMMs | Advanced Regression Models with R</title>
  <meta name="description" content="Advanced Regression with R" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="5 GLMMs | Advanced Regression Models with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Advanced Regression with R" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 GLMMs | Advanced Regression Models with R" />
  
  <meta name="twitter:description" content="Advanced Regression with R" />
  

<meta name="author" content="Florian Hartig" />


<meta name="date" content="2022-06-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="heteroskedasticity.html"/>
<link rel="next" href="correlation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="reminder.html"><a href="reminder.html"><i class="fa fa-check"></i><b>2</b> Reminder: R Basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reminder.html"><a href="reminder.html#your-r-system"><i class="fa fa-check"></i><b>2.1</b> Your R System</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="reminder.html"><a href="reminder.html#installing-libraries"><i class="fa fa-check"></i><b>2.1.1</b> Installing Libraries</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="reminder.html"><a href="reminder.html#representing-data-in-r"><i class="fa fa-check"></i><b>2.2</b> Representing Data in R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="reminder.html"><a href="reminder.html#exploring-data-structures"><i class="fa fa-check"></i><b>2.2.1</b> Exploring Data Structures</a></li>
<li class="chapter" data-level="2.2.2" data-path="reminder.html"><a href="reminder.html#dynamic-typing"><i class="fa fa-check"></i><b>2.2.2</b> Dynamic Typing</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="reminder.html"><a href="reminder.html#data-selection-slicing-and-subsetting"><i class="fa fa-check"></i><b>2.3</b> Data Selection, Slicing and Subsetting</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="reminder.html"><a href="reminder.html#subsetting-and-slicing-for-single-data-types"><i class="fa fa-check"></i><b>2.3.1</b> Subsetting and Slicing for Single Data Types</a></li>
<li class="chapter" data-level="2.3.2" data-path="reminder.html"><a href="reminder.html#logic-and-slicing"><i class="fa fa-check"></i><b>2.3.2</b> Logic and Slicing</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="reminder.html"><a href="reminder.html#applying-functions-and-aggregates-across-a-data-set"><i class="fa fa-check"></i><b>2.4</b> Applying Functions and Aggregates Across a Data Set</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="reminder.html"><a href="reminder.html#functions"><i class="fa fa-check"></i><b>2.4.1</b> Functions</a></li>
<li class="chapter" data-level="2.4.2" data-path="reminder.html"><a href="reminder.html#the-apply-function"><i class="fa fa-check"></i><b>2.4.2</b> The apply() Function</a></li>
<li class="chapter" data-level="2.4.3" data-path="reminder.html"><a href="reminder.html#the-aggregate-function"><i class="fa fa-check"></i><b>2.4.3</b> The aggregate() Function</a></li>
<li class="chapter" data-level="2.4.4" data-path="reminder.html"><a href="reminder.html#for-loops"><i class="fa fa-check"></i><b>2.4.4</b> For loops</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="reminder.html"><a href="reminder.html#plotting"><i class="fa fa-check"></i><b>2.5</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html"><i class="fa fa-check"></i><b>3</b> Understanding Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>3.1</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#fitting-and-interpreting-the-regression"><i class="fa fa-check"></i><b>3.1.1</b> Fitting and Interpreting the Regression</a></li>
<li class="chapter" data-level="3.1.2" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#centering-and-scaling-of-predictors"><i class="fa fa-check"></i><b>3.1.2</b> Centering and Scaling of Predictors</a></li>
<li class="chapter" data-level="3.1.3" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#residual-checks"><i class="fa fa-check"></i><b>3.1.3</b> Residual Checks</a></li>
<li class="chapter" data-level="3.1.4" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#categorical-predictors"><i class="fa fa-check"></i><b>3.1.4</b> Categorical Predictors</a></li>
<li class="chapter" data-level="3.1.5" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#plantTrait1"><i class="fa fa-check"></i><b>3.1.5</b> Exercise: Global Plant Trait Analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#multiple-regression"><i class="fa fa-check"></i><b>3.2</b> Multiple Regression</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#understanding-the-effect-of-collinearity"><i class="fa fa-check"></i><b>3.2.1</b> Understanding the Effect of Collinearity</a></li>
<li class="chapter" data-level="3.2.2" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#scaling-variables-in-the-multiple-regression"><i class="fa fa-check"></i><b>3.2.2</b> Scaling Variables in the Multiple Regression</a></li>
<li class="chapter" data-level="3.2.3" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#anova-for-multiple-regression"><i class="fa fa-check"></i><b>3.2.3</b> ANOVA for Multiple Regression</a></li>
<li class="chapter" data-level="3.2.4" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#interactions"><i class="fa fa-check"></i><b>3.2.4</b> Interactions</a></li>
<li class="chapter" data-level="3.2.5" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#plantTrait2"><i class="fa fa-check"></i><b>3.2.5</b> Exercise: Global Plant Trait Analysis #2</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#model-choice-and-causal-inference"><i class="fa fa-check"></i><b>3.3</b> Model Choice and Causal Inference</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#the-bias-variance-trade-off"><i class="fa fa-check"></i><b>3.3.1</b> The Bias-Variance Trade-off</a></li>
<li class="chapter" data-level="3.3.2" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#causal-inference"><i class="fa fa-check"></i><b>3.3.2</b> Causal Inference</a></li>
<li class="chapter" data-level="3.3.3" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#model-selection-methods"><i class="fa fa-check"></i><b>3.3.3</b> Model Selection Methods</a></li>
<li class="chapter" data-level="3.3.4" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#pHacking"><i class="fa fa-check"></i><b>3.3.4</b> P-hacking</a></li>
<li class="chapter" data-level="3.3.5" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#problems-of-stepwise-model-selection"><i class="fa fa-check"></i><b>3.3.5</b> Problems of Stepwise Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#case-studies"><i class="fa fa-check"></i><b>3.4</b> Case studies</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#exercise-global-plant-trait-analysis-3"><i class="fa fa-check"></i><b>3.4.1</b> Exercise: Global Plant Trait Analysis #3</a></li>
<li class="chapter" data-level="3.4.2" data-path="understanding_linear_regression.html"><a href="understanding_linear_regression.html#case-study-life-satisfaction"><i class="fa fa-check"></i><b>3.4.2</b> Case study: Life satisfaction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html"><i class="fa fa-check"></i><b>4</b> Heteroskedasticity and Grouped Data (Random Effects)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#adjusting-the-functional-form"><i class="fa fa-check"></i><b>4.1</b> Adjusting the Functional Form</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#changing-the-regression-formular"><i class="fa fa-check"></i><b>4.1.1</b> Changing the regression formular</a></li>
<li class="chapter" data-level="4.1.2" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#generalized-additive-models-gams"><i class="fa fa-check"></i><b>4.1.2</b> Generalized additive models (GAMs)</a></li>
<li class="chapter" data-level="4.1.3" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#exercise-functional-form"><i class="fa fa-check"></i><b>4.1.3</b> Exercise functional form</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#modelling-variance-terms"><i class="fa fa-check"></i><b>4.2</b> Modelling Variance Terms</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#transformation"><i class="fa fa-check"></i><b>4.2.1</b> Transformation</a></li>
<li class="chapter" data-level="4.2.2" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#model-the-variance"><i class="fa fa-check"></i><b>4.2.2</b> Model the variance</a></li>
<li class="chapter" data-level="4.2.3" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#exercise-variance-modelling"><i class="fa fa-check"></i><b>4.2.3</b> Exercise variance modelling</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#non-normality-and-outliers"><i class="fa fa-check"></i><b>4.3</b> Non-normality and Outliers</a></li>
<li class="chapter" data-level="4.4" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#random-and-mixed-effects---motivation"><i class="fa fa-check"></i><b>4.4</b> Random and Mixed Effects - Motivation</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#fitting-random-effects-models"><i class="fa fa-check"></i><b>4.4.1</b> Fitting Random Effects Models</a></li>
<li class="chapter" data-level="4.4.2" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#problems-with-mixed-models"><i class="fa fa-check"></i><b>4.4.2</b> Problems With Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#case-studies-1"><i class="fa fa-check"></i><b>4.5</b> Case studies</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#case-study-1-college-student-performance-over-time"><i class="fa fa-check"></i><b>4.5.1</b> Case Study 1: College Student Performance Over Time</a></li>
<li class="chapter" data-level="4.5.2" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#case-study-2---honeybee-data"><i class="fa fa-check"></i><b>4.5.2</b> Case Study 2 - Honeybee Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="GLMMs.html"><a href="GLMMs.html"><i class="fa fa-check"></i><b>5</b> GLMMs</a>
<ul>
<li class="chapter" data-level="5.1" data-path="GLMMs.html"><a href="GLMMs.html#basics"><i class="fa fa-check"></i><b>5.1</b> Basics</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="GLMMs.html"><a href="GLMMs.html#a-binomial-example"><i class="fa fa-check"></i><b>5.1.1</b> A Binomial Example</a></li>
<li class="chapter" data-level="5.1.2" data-path="GLMMs.html"><a href="GLMMs.html#a-poisson-example"><i class="fa fa-check"></i><b>5.1.2</b> A Poisson Example</a></li>
<li class="chapter" data-level="5.1.3" data-path="GLMMs.html"><a href="GLMMs.html#example---elk-data"><i class="fa fa-check"></i><b>5.1.3</b> Example - Elk Data</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="GLMMs.html"><a href="GLMMs.html#dispersion-problems-in-glms"><i class="fa fa-check"></i><b>5.2</b> Dispersion Problems in GLMs</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="GLMMs.html"><a href="GLMMs.html#heteroskedasticity-in-glmms"><i class="fa fa-check"></i><b>5.2.1</b> Heteroskedasticity in GLMMs</a></li>
<li class="chapter" data-level="5.2.2" data-path="GLMMs.html"><a href="GLMMs.html#zero-inflation"><i class="fa fa-check"></i><b>5.2.2</b> Zero-inflation</a></li>
<li class="chapter" data-level="5.2.3" data-path="GLMMs.html"><a href="GLMMs.html#p-hacking-link-collection"><i class="fa fa-check"></i><b>5.2.3</b> P-hacking Link Collection</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="GLMMs.html"><a href="GLMMs.html#protocol"><i class="fa fa-check"></i><b>5.3</b> Case Studies</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="GLMMs.html"><a href="GLMMs.html#owls"><i class="fa fa-check"></i><b>5.3.1</b> Owls</a></li>
<li class="chapter" data-level="5.3.2" data-path="GLMMs.html"><a href="GLMMs.html#hurricanes"><i class="fa fa-check"></i><b>5.3.2</b> Hurricanes</a></li>
<li class="chapter" data-level="5.3.3" data-path="GLMMs.html"><a href="GLMMs.html#researchers-degrees-of-freedom-skin-color-and-red-cards"><i class="fa fa-check"></i><b>5.3.3</b> Researchers Degrees of Freedom — Skin Color and Red Cards</a></li>
<li class="chapter" data-level="5.3.4" data-path="GLMMs.html"><a href="GLMMs.html#marmots"><i class="fa fa-check"></i><b>5.3.4</b> Marmots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>6</b> Correlation structures</a>
<ul>
<li class="chapter" data-level="6.1" data-path="correlation.html"><a href="correlation.html#general-idea"><i class="fa fa-check"></i><b>6.1</b> General Idea</a></li>
<li class="chapter" data-level="6.2" data-path="correlation.html"><a href="correlation.html#temporal-and-spatial-correlation-structures"><i class="fa fa-check"></i><b>6.2</b> Temporal and Spatial Correlation Structures</a></li>
<li class="chapter" data-level="6.3" data-path="correlation.html"><a href="correlation.html#phylogenetic-structures-pgls"><i class="fa fa-check"></i><b>6.3</b> Phylogenetic Structures (PGLS)</a></li>
<li class="chapter" data-level="6.4" data-path="correlation.html"><a href="correlation.html#exercices"><i class="fa fa-check"></i><b>6.4</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced_topics.html"><a href="advanced_topics.html"><i class="fa fa-check"></i><b>7</b> Summary and advanced topics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advanced_topics.html"><a href="advanced_topics.html#reminder-modelling-strategy"><i class="fa fa-check"></i><b>7.1</b> Reminder: Modelling Strategy</a></li>
<li class="chapter" data-level="7.2" data-path="advanced_topics.html"><a href="advanced_topics.html#thoughts-about-the-analysis-pipeline"><i class="fa fa-check"></i><b>7.2</b> Thoughts About the Analysis Pipeline</a></li>
<li class="chapter" data-level="7.3" data-path="advanced_topics.html"><a href="advanced_topics.html#nonparametric-estimators"><i class="fa fa-check"></i><b>7.3</b> Nonparametric estimators</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="advanced_topics.html"><a href="advanced_topics.html#the-bootstrap"><i class="fa fa-check"></i><b>7.3.1</b> The bootstrap</a></li>
<li class="chapter" data-level="7.3.2" data-path="advanced_topics.html"><a href="advanced_topics.html#cross-validation"><i class="fa fa-check"></i><b>7.3.2</b> Cross-validation</a></li>
<li class="chapter" data-level="7.3.3" data-path="advanced_topics.html"><a href="advanced_topics.html#null-models"><i class="fa fa-check"></i><b>7.3.3</b> Null Models</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="advanced_topics.html"><a href="advanced_topics.html#structural-equation-models-sems"><i class="fa fa-check"></i><b>7.4</b> Structural Equation Models (SEMs)</a></li>
<li class="chapter" data-level="7.5" data-path="advanced_topics.html"><a href="advanced_topics.html#intro-bayes"><i class="fa fa-check"></i><b>7.5</b> Intro Bayes</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Regression Models with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="GLMMs" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> GLMMs<a href="GLMMs.html#GLMMs" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!-- Put this here (right after the first markdown headline) and only here for each document! -->
<script src="./scripts/multipleChoice.js"></script>
<div id="basics" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Basics<a href="GLMMs.html#basics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Generalized linear models (GLMs) in R are fit with the <code class="sourceCode r"><span class="fu">glm</span>()</code> function. The main difference from <code class="sourceCode r"><span class="fu">lm</span>()</code> is that you can specify the ‘family’ parameter, which gives you the option to use different distributions than the normal distribution.</p>
<p>The family argument also includes the link function. The link function internally transforms a linear model on the predictors, so that its response corresponds to the range of the outcome distribution. If you don’t specify a link, the default link for each family is chosen. The most important are</p>
<ul>
<li>Log link for Poisson family.</li>
<li>Logit link for Bernoulli / Binomial family.</li>
</ul>
<p>Of course, there are many additional distributions that you could consider for your response. Here an overview of the most common choices:</p>
<p><img src="images/linkFunctions.jpg" width="150%" height="150%" /></p>
<p><small>Screenshot taken from Wikipedia: <a href="https://en.wikipedia.org/wiki/Generalized_linear_model#Link_function" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Generalized_linear_model#Link_function</a>. Content licensed under the <a href="https://en.wikipedia.org/wiki/Wikipedia:Text_of_Creative_Commons_Attribution-ShareAlike_3.0_Unported_License" target="_blank" rel="noopener">Creative Commons Attribution-ShareAlike License 3.0</a>.</small></p>
<div id="a-binomial-example" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> A Binomial Example<a href="GLMMs.html#a-binomial-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We want to look at the titanic data set. A cleaned version of this is in the package <code class="sourceCode r">EcoData</code>, which you have to install first from GitHub. If you haven’t already installed this package, I hope this works for you:</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="GLMMs.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;devtools&quot;)  # If you don&#39;t have the devtools package installed.</span></span>
<span id="cb353-2"><a href="GLMMs.html#cb353-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="at">repo =</span> <span class="st">&quot;TheoreticalEcology/EcoData&quot;</span>,</span>
<span id="cb353-3"><a href="GLMMs.html#cb353-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dependencies =</span> T, <span class="at">build_vignettes =</span> T)</span></code></pre></div>
<p>Let’s look at the titanic data set included in EcoData:</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="GLMMs.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EcoData)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;EcoData&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     cement</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="GLMMs.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(titanic)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1309 obs. of  14 variables:
##  $ pclass   : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ survived : int  1 1 0 0 0 1 1 0 1 0 ...
##  $ name     : chr  &quot;Allen, Miss. Elisabeth Walton&quot; &quot;Allison, Master. Hudson Trevor&quot; &quot;Allison, Miss. Helen Loraine&quot; &quot;Allison, Mr. Hudson Joshua Creighton&quot; ...
##  $ sex      : chr  &quot;female&quot; &quot;male&quot; &quot;female&quot; &quot;male&quot; ...
##  $ age      : num  29 0.917 2 30 25 ...
##  $ sibsp    : int  0 1 1 1 1 0 1 0 2 0 ...
##  $ parch    : int  0 2 2 2 2 0 0 0 0 0 ...
##  $ ticket   : chr  &quot;24160&quot; &quot;113781&quot; &quot;113781&quot; &quot;113781&quot; ...
##  $ fare     : num  211 152 152 152 152 ...
##  $ cabin    : chr  &quot;B5&quot; &quot;C22 C26&quot; &quot;C22 C26&quot; &quot;C22 C26&quot; ...
##  $ embarked : chr  &quot;S&quot; &quot;S&quot; &quot;S&quot; &quot;S&quot; ...
##  $ boat     : chr  &quot;2&quot; &quot;11&quot; &quot;&quot; &quot;&quot; ...
##  $ body     : int  NA NA NA 135 NA NA NA NA NA 22 ...
##  $ home.dest: chr  &quot;St Louis, MO&quot; &quot;Montreal, PQ / Chesterville, ON&quot; &quot;Montreal, PQ / Chesterville, ON&quot; &quot;Montreal, PQ / Chesterville, ON&quot; ...</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="GLMMs.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>( <span class="sc">~</span> survived <span class="sc">+</span> sex <span class="sc">+</span> pclass, <span class="at">data =</span> titanic)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk2-1.png" width="672" /></p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="GLMMs.html#cb360-1" aria-hidden="true" tabindex="-1"></a>titanic<span class="sc">$</span>pclass <span class="ot">=</span> <span class="fu">as.factor</span>(titanic<span class="sc">$</span>pclass)</span></code></pre></div>
<p>You can fit an lm, but the residual checks make it very evident that the data with a 0/1 response don’t fit to the assumption of an lm:</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="GLMMs.html#cb361-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lm</span>(survived <span class="sc">~</span> age, <span class="at">data =</span> titanic)</span>
<span id="cb361-2"><a href="GLMMs.html#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = survived ~ age, data = titanic)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.4642 -0.4156 -0.3796  0.5806  0.6867 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.464814   0.034973  13.291   &lt;2e-16 ***
## age         -0.001894   0.001054  -1.796   0.0727 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4912 on 1044 degrees of freedom
##   (263 observations deleted due to missingness)
## Multiple R-squared:  0.003082,   Adjusted R-squared:  0.002127 
## F-statistic: 3.227 on 1 and 1044 DF,  p-value: 0.07271</code></pre>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="GLMMs.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb363-2"><a href="GLMMs.html#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk3-1.png" width="672" /></p>
<p>Thus, what we want to fit is a logistic regression, which assumes a 0/1 response. In principle, this is distribution is called Bernoulli, but in R both 0/1 and k/n are called “binomial”, as Bernoulli is the special case of binomial where n = 1.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="GLMMs.html#cb364-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">=</span> <span class="fu">glm</span>(survived <span class="sc">~</span> sex, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">data =</span> titanic)</span>
<span id="cb364-2"><a href="GLMMs.html#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = survived ~ sex, family = &quot;binomial&quot;, data = titanic)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.6124  -0.6511  -0.6511   0.7977   1.8196  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   0.9818     0.1040   9.437   &lt;2e-16 ***
## sexmale      -2.4254     0.1360 -17.832   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1741.0  on 1308  degrees of freedom
## Residual deviance: 1368.1  on 1307  degrees of freedom
## AIC: 1372.1
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Can you interpret the output? What do the regression coefficients mean? This is a bit tricky. First of all, remember, if you want predictions, you have to apply the link function on the linear predictor. Binomial uses per default the logistic link, to calculate the response use:</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="GLMMs.html#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(<span class="fl">0.98</span>)  <span class="co"># Women.</span></span></code></pre></div>
<pre><code>## [1] 0.7271082</code></pre>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="GLMMs.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(<span class="fl">0.98</span> <span class="sc">-</span> <span class="fl">2.43</span>) <span class="co"># Men.</span></span></code></pre></div>
<pre><code>## [1] 0.1900016</code></pre>
<p>You can also use the predict function,</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="GLMMs.html#cb370-1" aria-hidden="true" tabindex="-1"></a>newDat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">sex =</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>)))</span>
<span id="cb370-2"><a href="GLMMs.html#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m1, <span class="at">newdata =</span> newDat, <span class="at">se =</span> T) <span class="co"># Linear predictor.</span></span></code></pre></div>
<pre><code>## $fit
##         1         2 
##  0.981813 -1.443625 
## 
## $se.fit
##          1          2 
## 0.10403774 0.08762108 
## 
## $residual.scale
## [1] 1</code></pre>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="GLMMs.html#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m1, <span class="at">newdata =</span> newDat, <span class="at">se =</span> T, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)  <span class="co"># Response scale.</span></span></code></pre></div>
<pre><code>## $fit
##         1         2 
## 0.7274678 0.1909846 
## 
## $se.fit
##          1          2 
## 0.02062636 0.01353829 
## 
## $residual.scale
## [1] 1</code></pre>
<p>or we just look at the effect plots</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="GLMMs.html#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb374-2"><a href="GLMMs.html#cb374-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-3"><a href="GLMMs.html#cb374-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(m1))</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk7-1.png" width="672" /></p>
<p>The same thing for a slightly more complicated model:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="GLMMs.html#cb375-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">=</span> <span class="fu">glm</span>(survived <span class="sc">~</span> sex<span class="sc">*</span>age, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">data =</span> titanic)</span>
<span id="cb375-2"><a href="GLMMs.html#cb375-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = survived ~ sex * age, family = &quot;binomial&quot;, data = titanic)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.0247  -0.7158  -0.5776   0.7707   2.2960  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.493381   0.254188   1.941 0.052257 .  
## sexmale     -1.154139   0.339337  -3.401 0.000671 ***
## age          0.022516   0.008535   2.638 0.008342 ** 
## sexmale:age -0.046276   0.011216  -4.126 3.69e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1414.6  on 1045  degrees of freedom
## Residual deviance: 1083.4  on 1042  degrees of freedom
##   (263 observations deleted due to missingness)
## AIC: 1091.4
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="GLMMs.html#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(m2))</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk8-1.png" width="672" /></p>
<p>Note:</p>
<ul>
<li>Treatment coding for factors works as before.</li>
<li>Age effects for male / female cannot directly be compared, because they are calculated at a different intercept, and through the nonlinear link, this leads to a different effect on the response. One option to solve this are the so-called <strong>odds ratios</strong>. Or just look at the response scale, e.g. via the effect plots, and interpret there!</li>
</ul>
<p><strong><em>Residual checks</em></strong></p>
<p>Let’s check m2 from the Titanic example:</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="GLMMs.html#cb378-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">=</span> <span class="fu">glm</span>(survived <span class="sc">~</span> sex<span class="sc">*</span>age, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">data =</span> titanic)</span></code></pre></div>
<p>First of all: Due to an unfortunate programming choice in R (Nerds: Check class(m2)), the standard residual plots</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="GLMMs.html#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb379-2"><a href="GLMMs.html#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m2)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk10-1.png" width="672" /></p>
<p>still work, but they don’t look any better than before, because they still check for normality of the residuals, while we are interested in the question of whether the residuals are binomially distributed. The <code>DHARMa</code>.{R} package solves this problem. Load the <code>DHARMa</code>.{R} package, which should have been installed with <code class="sourceCode r">EcoData</code> already:</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="GLMMs.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span></code></pre></div>
<p>Calculate residuals:</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="GLMMs.html#cb381-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">simulateResiduals</span>(m2)</span></code></pre></div>
<p>Standard plot:</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="GLMMs.html#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk13-1.png" width="672" /></p>
<p>Out of the help page: The function creates a plot with two panels. The left panel is a uniform Q-Q plot (calling <a href="https://rdrr.io/cran/DHARMa/man/plotQQunif.html" target="_blank" rel="noopener">plotQQunif</a>), and the right panel shows residuals against predicted values (calling <a href="hhttps://rdrr.io/cran/DHARMa/man/plotResiduals.html" target="_blank" rel="noopener">plotResiduals</a>), with outliers highlighted in red.</p>
<p>Very briefly, we would expect that a correctly specified model shows:</p>
<ol style="list-style-type: lower-alpha">
<li><p>A straight 1-1 line, as well as not significant of the displayed tests in the Q-Q-plot (left) -&gt; Evidence for a correct overall residual distribution (for more details on the interpretation of this plot, see help).</p></li>
<li><p>Visual homogeneity of residuals in both vertical and horizontal direction, as well as no significance of quantile tests in the Residual vs. predicted plot (for more details on the interpretation of this plot, see help).</p></li>
</ol>
<p>Deviations from these expectations can be interpreted similarly to a linear regression. See the vignette for detailed examples.</p>
<p>Also residuals against predictors shows no particular problem:</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="GLMMs.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb383-2"><a href="GLMMs.html#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(m2, <span class="at">form =</span> <span class="fu">model.frame</span>(m2)<span class="sc">$</span>age)</span>
<span id="cb383-3"><a href="GLMMs.html#cb383-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(m2, <span class="at">form =</span> <span class="fu">model.frame</span>(m2)<span class="sc">$</span>sex)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk14-1.png" width="672" /></p>
<p>Residuals against missing predictor show a clear problem:</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="GLMMs.html#cb384-1" aria-hidden="true" tabindex="-1"></a>dataUsed <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">rownames</span>(<span class="fu">model.frame</span>(m2)))</span>
<span id="cb384-2"><a href="GLMMs.html#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(m2, <span class="at">form =</span> titanic<span class="sc">$</span>pclass[dataUsed])</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk15-1.png" width="672" /></p>
<p>We will talk about <code>DHARMa</code>.{R} more later, see also comments on testing binomial GLMs<br />
<a href="https://cran.r-project.org/web/packages/DHARMa/vignettes/DHARMa.html#binomial-data" target="_blank" rel="noopener">here</a>.</p>
</div>
<div id="a-poisson-example" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> A Poisson Example<a href="GLMMs.html#a-poisson-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="GLMMs.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EcoData)</span>
<span id="cb385-2"><a href="GLMMs.html#cb385-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-3"><a href="GLMMs.html#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(birdfeeding)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    25 obs. of  2 variables:
##  $ feeding       : int  3 6 8 4 2 7 6 8 10 3 ...
##  $ attractiveness: int  1 1 1 1 1 2 2 2 2 2 ...</code></pre>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="GLMMs.html#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(feeding <span class="sc">~</span> attractiveness, <span class="at">data =</span> birdfeeding)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk16-1.png" width="672" /></p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="GLMMs.html#cb388-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">glm</span>(feeding <span class="sc">~</span> attractiveness, <span class="at">data =</span> birdfeeding, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb388-2"><a href="GLMMs.html#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = feeding ~ attractiveness, family = &quot;poisson&quot;, data = birdfeeding)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.55377  -0.72834   0.03699   0.59093   1.54584  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     1.47459    0.19443   7.584 3.34e-14 ***
## attractiveness  0.14794    0.05437   2.721  0.00651 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 25.829  on 24  degrees of freedom
## Residual deviance: 18.320  on 23  degrees of freedom
## AIC: 115.42
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Log link means that calculating predicted value for attractiveness requires exp(linear response).</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="GLMMs.html#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fl">1.47459</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fl">0.14794</span>)</span></code></pre></div>
<pre><code>## [1] 6.810122</code></pre>
<p>Effect plots, not the log scaling on the y axis</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="GLMMs.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(fit))</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk18-1.png" width="672" /></p>
<p>Residual checks are OK.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="GLMMs.html#cb393-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">simulateResiduals</span>(fit)</span>
<span id="cb393-2"><a href="GLMMs.html#cb393-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk19-1.png" width="672" /></p>
</div>
<div id="example---elk-data" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Example - Elk Data<a href="GLMMs.html#example---elk-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
  <hr/>
  <strong><span style="color: #0011AA; font-size:25px;">Task</span></strong><br/>
<p>Here a data set of habitat use of Elks in Canada. Measured is the presence of Elks (0/1), and a number of other predictors. Perform either:</p>
<ol style="list-style-type: lower-alpha">
<li>A predictive analysis, i.e. a model to predict where Elks can be found.</li>
<li>A causal analysis, trying to understand the effect of roads on Elk presence.</li>
</ol>
  <details>
    <summary>
      <strong><span style="color: #0011AA; font-size:25px;">Solution</span></strong>
    </summary>
    <p>
<p><strong><em>a</em></strong></p>
<p><strong><em>b</em></strong></p>
    </p>
  </details>
  <br/><hr/>
</div>
</div>
<div id="dispersion-problems-in-glms" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Dispersion Problems in GLMs<a href="GLMMs.html#dispersion-problems-in-glms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The problem with functions such as the Poisson or the Binomial (for k/n data) is, unlike the normal distribution, they do not have a parameter for the dispersion. That is, unlike the normal distribution, which can have different levels of spread around the regression line, <em>the Poisson distribution always assumes a certain mean corresponds to a fixed variance</em>.</p>
<p>This is obviously not always a good assumption. In most cases with count data, we actually find overdispersion (more dispersion than expected). You can, however, also have underdispersion, i.e. less dispersion than expected. Ways to treat this include</p>
<ol style="list-style-type: decimal">
<li><strong>Quasi-distributions</strong>, which are available in glm. Those add a term to the likelihood that corrects the p-values for the dispersion, but they are not distributions .-&gt; Can’t check residuals, no AIC. -&gt; Discouraged.</li>
<li><strong>Observation-level random effect (OLRE)</strong> - Add a separate random effect per observation. This effectively creates a normal random variate at the level of the linear predictor, increases variance on the responses.</li>
<li>A <strong>GLM distribution with variable dispersion</strong>, for Poisson usually the negative binomial.</li>
</ol>
<p>Because the 3rd option gives us more possibilities to model e.g. heteroskedasticity later, its preferable over an OLRE. I would always recommend the third option.</p>
<p><strong><em>Example:</em></strong></p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="GLMMs.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span>
<span id="cb394-2"><a href="GLMMs.html#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb394-3"><a href="GLMMs.html#cb394-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb394-4"><a href="GLMMs.html#cb394-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-5"><a href="GLMMs.html#cb394-5" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">=</span> <span class="fu">glm</span>(count <span class="sc">~</span> spp <span class="sc">+</span> mined, <span class="at">family =</span> poisson, <span class="at">data =</span> Salamanders)</span>
<span id="cb394-6"><a href="GLMMs.html#cb394-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = count ~ spp + mined, family = poisson, data = Salamanders)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.8155  -1.0024  -0.7241   0.0315   9.9255  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.33879    0.13811  -9.694  &lt; 2e-16 ***
## sppPR       -1.38629    0.21517  -6.443 1.17e-10 ***
## sppDM        0.23052    0.12889   1.789   0.0737 .  
## sppEC-A     -0.77011    0.17105  -4.502 6.73e-06 ***
## sppEC-L      0.62117    0.11931   5.206 1.92e-07 ***
## sppDES-L     0.67916    0.11813   5.749 8.96e-09 ***
## sppDF        0.08004    0.13344   0.600   0.5486    
## minedno      2.03676    0.11092  18.363  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 2120.7  on 643  degrees of freedom
## Residual deviance: 1310.3  on 636  degrees of freedom
## AIC: 2049.6
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="GLMMs.html#cb396-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">simulateResiduals</span>(m1, <span class="at">plot =</span> T)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk20-1.png" width="672" /></p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="GLMMs.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Looks overdispersed, additional check.</span></span>
<span id="cb397-2"><a href="GLMMs.html#cb397-2" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(res)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk20-2.png" width="672" /></p>
<pre><code>## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## dispersion = 3.9152, p-value &lt; 2.2e-16
## alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="GLMMs.html#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add random effect for site.</span></span>
<span id="cb399-2"><a href="GLMMs.html#cb399-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">=</span> <span class="fu">glmer</span>(count <span class="sc">~</span> spp <span class="sc">+</span> mined <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>site), <span class="at">family =</span> poisson, <span class="at">data =</span> Salamanders)</span>
<span id="cb399-3"><a href="GLMMs.html#cb399-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: poisson  ( log )
## Formula: count ~ spp + mined + (1 | site)
##    Data: Salamanders
## 
##      AIC      BIC   logLik deviance df.resid 
##   1962.8   2003.0   -972.4   1944.8      635 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.6006 -0.7446 -0.4143  0.0836 11.7241 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  site   (Intercept) 0.3313   0.5756  
## Number of obs: 644, groups:  site, 23
## 
## Fixed effects:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.62411    0.23853  -6.809 9.84e-12 ***
## sppPR       -1.38623    0.21416  -6.473 9.61e-11 ***
## sppDM        0.23048    0.12829   1.797   0.0724 .  
## sppEC-A     -0.77012    0.17026  -4.523 6.09e-06 ***
## sppEC-L      0.62111    0.11875   5.230 1.69e-07 ***
## sppDES-L     0.67911    0.11758   5.776 7.66e-09 ***
## sppDF        0.08004    0.13282   0.603   0.5468    
## minedno      2.26373    0.27869   8.123 4.56e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##          (Intr) sppPR  sppDM  spEC-A spEC-L sDES-L sppDF 
## sppPR    -0.180                                          
## sppDM    -0.300  0.334                                   
## sppEC-A  -0.226  0.252  0.420                            
## sppEC-L  -0.324  0.361  0.602  0.454                     
## sppDES-L -0.327  0.364  0.608  0.458  0.657              
## sppDF    -0.290  0.322  0.538  0.406  0.582  0.587       
## minedno  -0.733  0.000  0.000  0.000  0.000  0.000  0.000</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="GLMMs.html#cb401-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">simulateResiduals</span>(m2, <span class="at">plot =</span> T)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk20-3.png" width="672" /></p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="GLMMs.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now dispersion seems to be OK, rather another problem with heteroskedasticity, see next.</span></span>
<span id="cb402-2"><a href="GLMMs.html#cb402-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-3"><a href="GLMMs.html#cb402-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Just for the sake of completeness, if we would have still overdispersion,</span></span>
<span id="cb402-4"><a href="GLMMs.html#cb402-4" aria-hidden="true" tabindex="-1"></a><span class="co"># these would be the two options:</span></span>
<span id="cb402-5"><a href="GLMMs.html#cb402-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-6"><a href="GLMMs.html#cb402-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable dispersion via OLRE.</span></span>
<span id="cb402-7"><a href="GLMMs.html#cb402-7" aria-hidden="true" tabindex="-1"></a>Salamanders<span class="sc">$</span>ID <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Salamanders)</span>
<span id="cb402-8"><a href="GLMMs.html#cb402-8" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">=</span> <span class="fu">glmer</span>(count <span class="sc">~</span> spp <span class="sc">+</span> mined <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>site) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ID), <span class="at">family =</span> poisson, <span class="at">data =</span> Salamanders)</span>
<span id="cb402-9"><a href="GLMMs.html#cb402-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: poisson  ( log )
## Formula: count ~ spp + mined + (1 | site) + (1 | ID)
##    Data: Salamanders
## 
##      AIC      BIC   logLik deviance df.resid 
##   1671.5   1716.2   -825.8   1651.5      634 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -1.122 -0.458 -0.286  0.139  2.736 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  ID     (Intercept) 1.0111   1.0055  
##  site   (Intercept) 0.2459   0.4958  
## Number of obs: 644, groups:  ID, 644; site, 23
## 
## Fixed effects:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -2.1808     0.2838  -7.684 1.54e-14 ***
## sppPR        -1.4120     0.3065  -4.606 4.10e-06 ***
## sppDM         0.3801     0.2354   1.615 0.106389    
## sppEC-A      -0.7762     0.2710  -2.864 0.004185 ** 
## sppEC-L       0.5243     0.2332   2.248 0.024561 *  
## sppDES-L      0.8157     0.2279   3.579 0.000344 ***
## sppDF         0.2856     0.2386   1.197 0.231184    
## minedno       2.3197     0.2723   8.517  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##          (Intr) sppPR  sppDM  spEC-A spEC-L sDES-L sppDF 
## sppPR    -0.307                                          
## sppDM    -0.477  0.405                                   
## sppEC-A  -0.364  0.360  0.460                            
## sppEC-L  -0.474  0.412  0.541  0.467                     
## sppDES-L -0.504  0.418  0.557  0.475  0.560              
## sppDF    -0.480  0.400  0.532  0.455  0.537  0.553       
## minedno  -0.658 -0.023  0.029 -0.015  0.026  0.042  0.037
## optimizer (Nelder_Mead) convergence code: 0 (OK)
## Model failed to converge with max|grad| = 0.103661 (tol = 0.002, component 1)</code></pre>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="GLMMs.html#cb404-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">simulateResiduals</span>(m3, <span class="at">plot =</span> T)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk20-4.png" width="672" /></p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="GLMMs.html#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable dispersion via negative binomial.</span></span>
<span id="cb405-2"><a href="GLMMs.html#cb405-2" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">=</span> <span class="fu">glmmTMB</span>(count <span class="sc">~</span> spp <span class="sc">+</span> mined <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>site), <span class="at">family =</span> nbinom2, <span class="at">data =</span> Salamanders)</span>
<span id="cb405-3"><a href="GLMMs.html#cb405-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4)</span></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          count ~ spp + mined + (1 | site)
## Data: Salamanders
## 
##      AIC      BIC   logLik deviance df.resid 
##   1672.4   1717.1   -826.2   1652.4      634 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  site   (Intercept) 0.2945   0.5426  
## Number of obs: 644, groups:  site, 23
## 
## Dispersion parameter for nbinom2 family (): 0.942 
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -1.6832     0.2742  -6.140 8.28e-10 ***
## sppPR        -1.3197     0.2875  -4.591 4.42e-06 ***
## sppDM         0.3686     0.2235   1.649 0.099056 .  
## sppEC-A      -0.7098     0.2530  -2.806 0.005017 ** 
## sppEC-L       0.5714     0.2191   2.608 0.009105 ** 
## sppDES-L      0.7929     0.2166   3.660 0.000252 ***
## sppDF         0.3120     0.2329   1.340 0.180337    
## minedno       2.2633     0.2838   7.975 1.53e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="GLMMs.html#cb407-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">simulateResiduals</span>(m4, <span class="at">plot =</span> T)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk20-5.png" width="672" /></p>
<div id="heteroskedasticity-in-glmms" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Heteroskedasticity in GLMMs<a href="GLMMs.html#heteroskedasticity-in-glmms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>GLM(M)s can be heteroskedastic as well, i.e. dispersion depends on some predictors. In <code>glmmTMB</code>.{R}, you can make the dispersion of the negative Binomial dependent on a formula via the <code>dispformula</code>.{R} argument, in the same way as in <code>nlme</code>.{R} for the linear model.</p>
<p>Variance problems would show up when plotting residuals against predicted and predictors. On the previous page, we saw some variance problems in the Salamander model. We could add a variable dispersion model via</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="GLMMs.html#cb408-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">=</span> <span class="fu">glmmTMB</span>(count <span class="sc">~</span> spp <span class="sc">+</span> mined <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>site), <span class="at">family =</span> nbinom1,</span>
<span id="cb408-2"><a href="GLMMs.html#cb408-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">dispformula =</span> <span class="sc">~</span> spp <span class="sc">+</span> mined ,  <span class="at">data =</span> Salamanders)</span>
<span id="cb408-3"><a href="GLMMs.html#cb408-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code></pre></div>
<pre><code>##  Family: nbinom1  ( log )
## Formula:          count ~ spp + mined + (1 | site)
## Dispersion:             ~spp + mined
## Data: Salamanders
## 
##      AIC      BIC   logLik deviance df.resid 
##   1654.4   1730.3   -810.2   1620.4      627 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  site   (Intercept) 0.2283   0.4778  
## Number of obs: 644, groups:  site, 23
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -1.5288     0.2799  -5.462 4.70e-08 ***
## sppPR        -1.3304     0.3480  -3.822 0.000132 ***
## sppDM         0.2695     0.2004   1.345 0.178561    
## sppEC-A      -0.7525     0.2772  -2.714 0.006641 ** 
## sppEC-L       0.6228     0.2109   2.952 0.003155 ** 
## sppDES-L      0.7113     0.1976   3.600 0.000318 ***
## sppDF         0.1470     0.2171   0.677 0.498259    
## minedno       2.1348     0.2825   7.557 4.14e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Dispersion model:
##             Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)  -0.2834     0.6414  -0.442   0.6586  
## sppPR         0.3160     0.7501   0.421   0.6735  
## sppDM         0.1979     0.5712   0.346   0.7289  
## sppEC-A       0.3592     0.6477   0.554   0.5792  
## sppEC-L       1.0830     0.5215   2.077   0.0378 *
## sppDES-L      0.7951     0.5370   1.481   0.1387  
## sppDF         0.3769     0.6109   0.617   0.5373  
## minedno       0.5583     0.4187   1.334   0.1823  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="GLMMs.html#cb410-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">simulateResiduals</span>(m3, <span class="at">plot =</span> T)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk21-1.png" width="672" /></p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="GLMMs.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb411-2"><a href="GLMMs.html#cb411-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(res, Salamanders<span class="sc">$</span>spp)</span>
<span id="cb411-3"><a href="GLMMs.html#cb411-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(res, Salamanders<span class="sc">$</span>mined)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk21-2.png" width="672" /></p>
</div>
<div id="zero-inflation" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Zero-inflation<a href="GLMMs.html#zero-inflation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another common problem in count data (Poisson / negative binomial), but also other GLMs (e.g. beta) is that the observed data has more zeros than expected by the fitted distribution. To deal with this <strong>zero-inflation</strong>, we have to add an additional model component that controls how many zeros are produced. The default way to do this is assuming two separate processes which act after one another:</p>
<ol style="list-style-type: decimal">
<li>A binomial model for 0 or not,</li>
<li>if is not zero, a number from Poisson or negative binomial.</li>
</ol>
<p>Note that the result of 2. can again be zero, so there are two explanations for a zero in the data.</p>
<p>Zero-inflated GLMMs can, for example, be fit with the <code>glmmTMB</code>.{R} package, using <code class="sourceCode r">ziformula <span class="ot">=</span> <span class="er">~</span> <span class="dv">0</span></code>.</p>
<p><strong><em>How to check for zero-inflation</em></strong></p>
<p><em>Important</em>: Do not check for zero-inflation in the response.</p>
<p><code>DHARMa</code>.{R} has a function for testing zero-inflation:</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="GLMMs.html#cb412-1" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">=</span> <span class="fu">glmmTMB</span>(count <span class="sc">~</span> spp <span class="sc">+</span> mined <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>site), <span class="at">family =</span> nbinom2, <span class="at">data =</span> Salamanders)</span>
<span id="cb412-2"><a href="GLMMs.html#cb412-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4)</span></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          count ~ spp + mined + (1 | site)
## Data: Salamanders
## 
##      AIC      BIC   logLik deviance df.resid 
##   1672.4   1717.1   -826.2   1652.4      634 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  site   (Intercept) 0.2945   0.5426  
## Number of obs: 644, groups:  site, 23
## 
## Dispersion parameter for nbinom2 family (): 0.942 
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -1.6832     0.2742  -6.140 8.28e-10 ***
## sppPR        -1.3197     0.2875  -4.591 4.42e-06 ***
## sppDM         0.3686     0.2235   1.649 0.099056 .  
## sppEC-A      -0.7098     0.2530  -2.806 0.005017 ** 
## sppEC-L       0.5714     0.2191   2.608 0.009105 ** 
## sppDES-L      0.7929     0.2166   3.660 0.000252 ***
## sppDF         0.3120     0.2329   1.340 0.180337    
## minedno       2.2633     0.2838   7.975 1.53e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="GLMMs.html#cb414-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">simulateResiduals</span>(m4, <span class="at">plot =</span> T)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk22-1.png" width="672" /></p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="GLMMs.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testZeroInflation</span>(res)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_chunk22-2.png" width="672" /></p>
<pre><code>## 
##  DHARMa zero-inflation test via comparison to expected zeros with
##  simulation under H0 = fitted model
## 
## data:  simulationOutput
## ratioObsSim = 1.0172, p-value = 0.744
## alternative hypothesis: two.sided</code></pre>
<p>Problem with this: When there is really zero-inflation, variable dispersion models such as the Poisson often simply increase the dispersion to account for the zeros, leading to no apparent zero-inflation in the residuals, but rather underdispersion.</p>
<p>Thus, if you see underdispersion in variable-dispersion GLM for count data, check for zero-inflation. Reliable check is to simply compare a zero-inflation model via AIC or likelihood ratio test.</p>
</div>
<div id="p-hacking-link-collection" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> P-hacking Link Collection<a href="GLMMs.html#p-hacking-link-collection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the context of GLM(M)s, you have also to be careful about p-hacking. See <a href="understanding_linear_regression.html#pHacking">3.3.4</a>.</p>
</div>
</div>
<div id="protocol" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Case Studies<a href="GLMMs.html#protocol" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Strategy for analysis:</p>
<ol style="list-style-type: decimal">
<li>Define formula via scientific questions + confounders.</li>
<li>Define type of GLM (lm, logistic, Poisson).</li>
<li>Blocks in data -&gt; Random effects, start with random intercept.</li>
</ol>
<p>Fit this base model, then do residual checks for</p>
<ul>
<li>Wrong functional form -&gt; Change fitted function.</li>
<li>Wrong distribution-&gt; Transformation or GLM adjustment.</li>
<li>(Over)dispersion -&gt; Variable dispersion GLM.</li>
<li>Heteroskedasticity -&gt; Model dispersion.</li>
<li>Zero-inflation -&gt; Add ZIP term.</li>
<li>…</li>
</ul>
<p>And adjust the model accordingly.</p>
<div id="owls" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Owls<a href="GLMMs.html#owls" class="anchor-section" aria-label="Anchor link to header"></a></h3>
  <hr/>
  <strong><span style="color: #0011AA; font-size:25px;">Task</span></strong><br/>
<p>Look at the Owl data set in the <code>glmmTMB</code>.{R} package. The initial hypothesis is</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="GLMMs.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span>
<span id="cb417-2"><a href="GLMMs.html#cb417-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-3"><a href="GLMMs.html#cb417-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">=</span> <span class="fu">glm</span>(SiblingNegotiation <span class="sc">~</span> FoodTreatment<span class="sc">*</span>SexParent <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(BroodSize)),</span>
<span id="cb417-4"><a href="GLMMs.html#cb417-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> Owls , <span class="at">family =</span> poisson)</span>
<span id="cb417-5"><a href="GLMMs.html#cb417-5" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">simulateResiduals</span>(m1)</span>
<span id="cb417-6"><a href="GLMMs.html#cb417-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_task_3-1.png" width="672" /></p>
<p>The offset is a special command that can be used in all regression models.</p>
<ul>
<li><em>First, try to understand what the offset does</em>!</li>
<li>Then, try to improve the model with everything we have discussed so far.</li>
</ul>
  <details>
    <summary>
      <strong><span style="color: #0011AA; font-size:25px;">Possible solution</span></strong>
    </summary>
    <p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="GLMMs.html#cb418-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">=</span> glmmTMB<span class="sc">::</span><span class="fu">glmmTMB</span>(SiblingNegotiation <span class="sc">~</span> FoodTreatment <span class="sc">*</span> SexParent </span>
<span id="cb418-2"><a href="GLMMs.html#cb418-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Nest) <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(BroodSize)), <span class="at">data =</span> Owls , <span class="at">family =</span> nbinom1,</span>
<span id="cb418-3"><a href="GLMMs.html#cb418-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dispformula =</span> <span class="sc">~</span> FoodTreatment <span class="sc">+</span> SexParent,</span>
<span id="cb418-4"><a href="GLMMs.html#cb418-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ziformula =</span> <span class="sc">~</span> FoodTreatment <span class="sc">+</span> SexParent)</span>
<span id="cb418-5"><a href="GLMMs.html#cb418-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div>
<pre><code>##  Family: nbinom1  ( log )
## Formula:          
## SiblingNegotiation ~ FoodTreatment * SexParent + (1 | Nest) +  
##     offset(log(BroodSize))
## Zero inflation:                      ~FoodTreatment + SexParent
## Dispersion:                          ~FoodTreatment + SexParent
## Data: Owls
## 
##      AIC      BIC   logLik deviance df.resid 
##   3354.6   3402.9  -1666.3   3332.6      588 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  Nest   (Intercept) 0.0876   0.296   
## Number of obs: 599, groups:  Nest, 27
## 
## Conditional model:
##                                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                          0.80028    0.09736   8.220  &lt; 2e-16 ***
## FoodTreatmentSatiated               -0.46893    0.16760  -2.798  0.00514 ** 
## SexParentMale                       -0.09127    0.09247  -0.987  0.32363    
## FoodTreatmentSatiated:SexParentMale  0.13087    0.19028   0.688  0.49158    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Zero-inflation model:
##                       Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)            -1.9132     0.3269  -5.853 4.84e-09 ***
## FoodTreatmentSatiated   1.0564     0.4072   2.594  0.00948 ** 
## SexParentMale          -0.4688     0.3659  -1.281  0.20012    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Dispersion model:
##                       Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)             1.2122     0.2214   5.475 4.37e-08 ***
## FoodTreatmentSatiated   0.7978     0.2732   2.920   0.0035 ** 
## SexParentMale          -0.1540     0.2399  -0.642   0.5209    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="GLMMs.html#cb420-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">simulateResiduals</span>(m1, <span class="at">plot =</span> T)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_task_4-1.png" width="672" /></p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="GLMMs.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(m1)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_task_4-2.png" width="672" /></p>
<pre><code>## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## dispersion = 0.78311, p-value = 0.104
## alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="GLMMs.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testZeroInflation</span>(m1)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_task_4-3.png" width="672" /></p>
<pre><code>## 
##  DHARMa zero-inflation test via comparison to expected zeros with
##  simulation under H0 = fitted model
## 
## data:  simulationOutput
## ratioObsSim = 1.0465, p-value = 0.608
## alternative hypothesis: two.sided</code></pre>
    </p>
  </details>
  <br/><hr/>
</div>
<div id="hurricanes" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Hurricanes<a href="GLMMs.html#hurricanes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
  <hr/>
  <strong><span style="color: #0011AA; font-size:25px;">Task</span></strong><br/>
<p>In <a href="https://www.pnas.org/content/111/24/8782" target="_blank" rel="noopener">https://www.pnas.org/content/111/24/8782</a>, Jung et al. claim that “Female hurricanes are deadlier than male hurricanes”.</p>
<p>Specifically, they analyze the number of hurricane fatalities, and claim that there is an effect of the femininity of the name on the number of fatalities, correcting for several possible confounders. They interpret the result as causal (including mediators), claiming that giving only male names to hurricanes would considerably reduce death toll.</p>
<p>The data is available in <code class="sourceCode r">DHARMa</code>.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="GLMMs.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb425-2"><a href="GLMMs.html#cb425-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb425-3"><a href="GLMMs.html#cb425-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-4"><a href="GLMMs.html#cb425-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hurricanes)</span></code></pre></div>
<pre><code>## tibble [92 × 14] (S3: tbl_df/tbl/data.frame)
##  $ Year                    : num [1:92] 1950 1950 1952 1953 1953 ...
##  $ Name                    : chr [1:92] &quot;Easy&quot; &quot;King&quot; &quot;Able&quot; &quot;Barbara&quot; ...
##  $ MasFem                  : num [1:92] 6.78 1.39 3.83 9.83 8.33 ...
##  $ MinPressure_before      : num [1:92] 958 955 985 987 985 960 954 938 962 987 ...
##  $ Minpressure_Updated_2014: num [1:92] 960 955 985 987 985 960 954 938 962 987 ...
##  $ Gender_MF               : num [1:92] 1 0 0 1 1 1 1 1 1 1 ...
##  $ Category                : num [1:92] 3 3 1 1 1 3 3 4 3 1 ...
##  $ alldeaths               : num [1:92] 2 4 3 1 0 60 20 20 0 200 ...
##  $ NDAM                    : num [1:92] 1590 5350 150 58 15 ...
##  $ Elapsed_Yrs             : num [1:92] 63 63 61 60 60 59 59 59 58 58 ...
##  $ Source                  : chr [1:92] &quot;MWR&quot; &quot;MWR&quot; &quot;MWR&quot; &quot;MWR&quot; ...
##  $ ZMasFem                 : num [1:92] -0.000935 -1.670758 -0.913313 0.945871 0.481075 ...
##  $ ZMinPressure_A          : num [1:92] -0.356 -0.511 1.038 1.141 1.038 ...
##  $ ZNDAM                   : num [1:92] -0.439 -0.148 -0.55 -0.558 -0.561 ...</code></pre>
<p>Some plots:</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="GLMMs.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hurricanes<span class="sc">$</span>MasFem, hurricanes<span class="sc">$</span>NDAM, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">pch =</span> <span class="dv">5</span>)</span>
<span id="cb427-2"><a href="GLMMs.html#cb427-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(hurricanes<span class="sc">$</span>MasFem, hurricanes<span class="sc">$</span>NDAM, <span class="at">cex =</span> hurricanes<span class="sc">$</span>alldeaths<span class="sc">/</span><span class="dv">20</span>,</span>
<span id="cb427-3"><a href="GLMMs.html#cb427-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">4</span>, <span class="at">col=</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/chunk_chapter5_task_6-1.png" width="672" /></p>
<p>The original model from the paper fits a negative binomial, using <code>mgcv</code>.{R}.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="GLMMs.html#cb428-1" aria-hidden="true" tabindex="-1"></a>originalModelGAM <span class="ot">=</span> <span class="fu">gam</span>(alldeaths <span class="sc">~</span> MasFem <span class="sc">*</span> (Minpressure_Updated_2014 <span class="sc">+</span> NDAM), </span>
<span id="cb428-2"><a href="GLMMs.html#cb428-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> hurricanes, <span class="at">family =</span> nb, <span class="at">na.action =</span> <span class="st">&quot;na.fail&quot;</span>)</span>
<span id="cb428-3"><a href="GLMMs.html#cb428-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(originalModelGAM)</span></code></pre></div>
<pre><code>## 
## Family: Negative Binomial(0.736) 
## Link function: log 
## 
## Formula:
## alldeaths ~ MasFem * (Minpressure_Updated_2014 + NDAM)
## 
## Parametric coefficients:
##                                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                      7.014e+01  2.003e+01   3.502 0.000462 ***
## MasFem                          -5.986e+00  2.529e+00  -2.367 0.017927 *  
## Minpressure_Updated_2014        -7.008e-02  2.060e-02  -3.402 0.000669 ***
## NDAM                            -3.845e-05  2.945e-05  -1.305 0.191735    
## MasFem:Minpressure_Updated_2014  6.124e-03  2.603e-03   2.352 0.018656 *  
## MasFem:NDAM                      1.593e-05  3.756e-06   4.242 2.21e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## R-sq.(adj) =  -3.61e+03   Deviance explained = 57.4%
## -REML = 357.56  Scale est. = 1         n = 92</code></pre>
<p>Tasks:</p>
<ul>
<li>Confirm that you get the same results as in the paper.</li>
<li>Forget what they did. Go back to start, do a causal analysis like we did, and do your own model, diagnosing all residual problems that we discussed.</li>
</ul>
  <details>
    <summary>
      <strong><span style="color: #0011AA; font-size:25px;">Solution</span></strong>
    </summary>
    <p>
    </p>
  </details>
  <br/><hr/>
</div>
<div id="researchers-degrees-of-freedom-skin-color-and-red-cards" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Researchers Degrees of Freedom — Skin Color and Red Cards<a href="GLMMs.html#researchers-degrees-of-freedom-skin-color-and-red-cards" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In 2018 Silberzahn et al. published a “meta analysis” in <em>Advances in Methods and Practices in Psychological Science</em>, where they had provided 29 teams with the same data set to answer one research question: “<em>[W]hether soccer players with dark skin tone are more likely than those with light skin tone to receive red cards from referees</em>”.</p>
<p><strong>Spoiler</strong>: They found that the “[a]nalytic approaches varied widely across the teams, and the estimated effect sizes ranged from 0.89 to 2.93 (Mdn = 1.31) in odds-ratio units”, highlighting that different approaches in data analysis can yield significant variation in the results.</p>
<p>You can find the paper “Many Analysts, One Data Set: Making Transparent How Variations in Analytic Choices Affect Results” at: <a href="https://journals.sagepub.com/doi/10.1177/2515245917747646" target="_blank" rel="noopener">https://journals.sagepub.com/doi/10.1177/2515245917747646</a>.</p>
  <hr/>
  <strong><span style="color: #0011AA; font-size:25px;">Task</span></strong><br/>
<p>Do a re-analysis of the data as if you were the 30th team to contribute the results to the meta analysis.</p>
<ul>
<li>Download the data file “CrowdstormingDataJuly1st.csv” here: <a href="https://osf.io/fv8c3/" target="_blank" rel="noopener">https://osf.io/fv8c3/</a>.</li>
<li>Variable explanations are provided in the README: <a href="https://osf.io/9yh4x/" target="_blank" rel="noopener">https://osf.io/9yh4x/</a>.</li>
<li>Analyze the data. Given the research question, the selected variables are:
<ol style="list-style-type: decimal">
<li>Response variable: ‘redCards’ (+‘yellowReds’?).</li>
<li>Multiple variables, potentially accounting for confounding, offsetting, grouping, … are included in the data.</li>
<li>primary predictors: ‘rater1’, ‘rater2’</li>
</ol>
<ul>
<li>These variables reflect ratings of “two independent raters blind to the research question who, based on their profile photo, categorized players on a 5-point scale ranging from (1) very light skin to (5) very dark skin.</li>
<li>Make sure that ‘rater1’ and ‘rater2’ are rescaled to the range 0 … 1 as described in the paper (“This variable was rescaled to be bounded by 0 (very light skin) and 1 (very dark skin) prior to the final analysis, to ensure consistency of effect sizes across the teams of analysts. The raw ratings were rescaled to 0, .25, .50, .75, and 1 to create this new scale.”)</li>
</ul></li>
<li>Research the concept of <strong>odd ratios</strong> and convert your effect estimate into this format. Are your results within the range of estimates from the 29 teams in Silberzahn et al. (2018)?</li>
<li>Have a look at the other modelling teams. Do you understand the models they fit?</li>
</ul>
  <details>
    <summary>
      <strong><span style="color: #0011AA; font-size:25px;">Solution</span></strong>
    </summary>
    <p>
    </p>
  </details>
  <br/><hr/>
</div>
<div id="marmots" class="section level3 hasAnchor" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> Marmots<a href="GLMMs.html#marmots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
  <hr/>
  <strong><span style="color: #0011AA; font-size:25px;">Task</span></strong><br/>
<p>Analyze the Marmot data you can find in <code class="sourceCode r">EcoData</code>. A description of the data is available <a href="https://elearning.uni-regensburg.de/pluginfile.php/1922323/mod_assign/introattachment/0/Marmots.pdf?forcedownload=1" target="_blank" rel="noopener">https://osf.io/9yh4x/</a>.</p>
<p>Use the following snippet to read in the data:</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="GLMMs.html#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EcoData)</span>
<span id="cb430-2"><a href="GLMMs.html#cb430-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-3"><a href="GLMMs.html#cb430-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(marmots)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    896 obs. of  55 variables:
##  $ ANIMAL      : int  15 15 15 15 15 15 17 22 38 40 ...
##  $ YEAR        : int  1973 1974 1975 1976 1978 1979 1971 1969 1975 1994 ...
##  $ AGE         : int  3 4 5 6 8 9 2 2 2 2 ...
##  $ REPLAST     : int  NA 0 0 0 1 1 NA NA NA NA ...
##  $ YOUNG       : int  0 0 0 3 3 4 0 0 0 0 ...
##  $ MYEARL      : int  0 0 0 0 0 1 0 0 0 0 ...
##  $ FYEARL      : int  0 0 0 0 0 2 0 0 0 0 ...
##  $ MATRILINE   : int  1 1 1 1 1 1 1 2 1 4 ...
##  $ OTHFEM      : int  0 0 1 1 2 2 2 0 0 4 ...
##  $ MALEPRES    : logi  TRUE FALSE TRUE TRUE TRUE TRUE ...
##  $ NEWMALE     : logi  TRUE FALSE TRUE FALSE FALSE TRUE ...
##  $ YOUNGAD     : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ OFFSPYOUNG  : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ OLDAD       : int  0 0 0 0 0 0 0 1 0 1 ...
##  $ OFFSPOLD    : int  0 0 0 0 0 0 0 5 0 0 ...
##  $ SAMEAD      : int  0 0 0 0 0 0 0 0 0 2 ...
##  $ OFFSSAME    : int  0 0 0 0 0 0 0 0 0 4 ...
##  $ X2YR        : int  0 0 0 0 2 2 0 0 0 0 ...
##  $ GPUP        : int  0 0 0 0 0 6 0 0 0 0 ...
##  $ MYOUNGAM    : num  NA NA NA 0.333 NA ...
##  $ FYOUNGAM    : num  NA NA NA 0.444 NA ...
##  $ MYEARLAM    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ FYEARLAM    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ FADAM       : num  NA NA NA NA NA ...
##  $ MYEARLAG    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ FYEARLAG    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ FADAG       : num  NA NA NA NA NA NA NA 0 NA 0.002 ...
##  $ MYEARLAMNK  : num  NA NA NA 0.009 NA NA NA 0 NA 0 ...
##  $ FYEARLAMNK  : num  NA NA NA NA NA 0 NA 0 NA 0 ...
##  $ FADAMNK     : num  NA NA NA 0 NA 0 NA NA NA 0 ...
##  $ MYEARLAGNK  : num  NA NA NA 0 NA NA NA 0 NA 0 ...
##  $ FYEARLAGNK  : num  NA NA NA NA NA ...
##  $ FADAGNK     : num  NA NA NA 0 NA 0.013 NA NA NA 0.009 ...
##  $ COLONY      : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ ELEV        : int  2867 2867 2867 2867 2867 2867 2867 2867 2867 2867 ...
##  $ RESIDENT    : int  0 0 0 0 0 0 1 0 1 1 ...
##  $ FSNOWF      : int  296 282 302 286 305 295 283 281 302 283 ...
##  $ LSNOWF      : int  122 134 161 108 128 129 129 106 161 130 ...
##  $ FSNOWC      : int  300 335 302 323 322 316 312 304 302 309 ...
##  $ LSNOWC      : int  120 125 130 109 120 116 101 109 130 102 ...
##  $ LWINT1      : int  191 217 224 187 188 119 211 190 224 212 ...
##  $ LWINT2      : int  185 155 193 151 163 165 154 169 193 158 ...
##  $ GROWSEAS1   : int  202 215 177 193 226 196 187 182 177 181 ...
##  $ GROWSEAS2   : int  120 75 55 101 119 101 125 110 55 102 ...
##  $ SEPMAYPRECIP: num  22.7 15.3 17.4 12.8 24.7 ...
##  $ JUNEPRECIP  : num  1.62 1.61 0.93 1.03 0.16 ...
##  $ JULYPRECIP  : num  0.57 1.42 1.95 2.55 2.78 ...
##  $ AUGPRECIP   : num  1.39 1.22 1.32 0.66 1.41 ...
##  $ JUNJULPRECIP: num  2.19 3.03 2.88 3.58 2.94 ...
##  $ JULAUGPRECIP: num  1.96 2.64 3.27 3.21 4.19 ...
##  $ JUNAUGPRECIP: num  3.58 4.25 4.2 4.24 4.35 ...
##  $ TEMPSEPTNOV : num  36.6 37.2 35.8 35.8 39.1 ...
##  $ TEMPJUNAUG  : num  55.6 53.9 51.8 51.1 55.8 ...
##  $ MATDOM      : int  NA NA NA NA NA NA NA NA NA 54 ...
##  $ ADFEMDOM    : int  NA NA NA 3 0 15 NA NA NA 19 ...</code></pre>
  <details>
    <summary>
      <strong><span style="color: #0011AA; font-size:25px;">Solution</span></strong>
    </summary>
    <p>
    </p>
  </details>
  <br/><hr/>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="heteroskedasticity.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="correlation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
